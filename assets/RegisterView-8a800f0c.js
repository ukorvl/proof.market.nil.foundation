import{r as s,b as Q,aQ as D,aC as K,aR as X,aS as _,aM as f,P as U,aE as Y,aT as Z,j as e,d as r,aH as l,aU as a,aI as o,aJ as u,au as p,aK as q,aN as g,aL as w,ao as ee,aV as se,aW as ae,aO as re,aX as te,F as ne,W as ie}from"./index-0d04c63d.js";import{A as oe}from"./AuthCard-b5d77778.js";const ce=3,P=30,le=()=>{const[N,R]=s.useState(),[d,b]=s.useState(!0),{state:x}=Q(),[m,F]=s.useState("password"),T=m==="password"?"fa-eye-slash":"fa-eye",W=()=>F(m==="password"?"text":"password"),y=s.useRef(null),v=s.useRef(null),M=s.useRef(null),h=s.useRef(null),$=D(),{handleSubmit:z,watch:O,register:S,formState:{isSubmitting:k,errors:E,isValid:V,dirtyFields:c}}=K({mode:"onChange"}),j=z(async t=>{var n;R("");try{await X(t),(n=_)==null||n.create({title:"Registration success",message:`Successfully register new user ${t.user}`,variant:f.success}),$(U.login,{state:x})}catch(i){const A=await Y(i);let C="Register error";A&&(C+=`: ${A}`),R(C)}});s.useEffect(()=>{h.current&&h.current.focus()},[]);const{ref:B,...G}=S("user",{required:!0,minLength:ce,maxLength:P}),H=s.useMemo(()=>!!c.user,[c.user]),J=s.useMemo(()=>!!c.passwd,[c.passwd]),I=s.useRef(Z(async t=>{var n;if(t)try{await te(t),b(!1)}catch(i){((n=i==null?void 0:i.response)==null?void 0:n.status)===404&&b(!0)}},180)).current,L=O("user");return s.useEffect(()=>{I(L)},[L,I]),e(oe,{children:r(l,{className:a.form,children:[r("div",{children:[e("h4",{className:a.title,children:"Welcome to Proof Market!"}),e("div",{className:`${a.heading} text-muted`,children:"Create new account"}),r(l.Group,{hasError:!!E.user||!d,children:[r(o,{size:u.lg,className:a.control,children:[e(o.Addon,{children:e(p,{iconName:"fa-solid fa-user",className:a.icon})}),e(q,{type:"text",id:"userName",placeholder:"username","aria-label":"username",ref:t=>{B(t),h.current=t},...G})]}),!d&&e(l.Hint,{children:"Username should be unique"})]}),e(g,{classNames:"fade",timeout:300,in:H,unmountOnExit:!0,nodeRef:y,children:e("div",{ref:y,children:e(l.Group,{hasError:!!E.passwd,children:r(o,{size:u.lg,className:a.control,children:[e(o.Addon,{children:e(p,{iconName:"fa-solid fa-lock",className:a.icon})}),e(q,{type:m,id:"password",placeholder:"password","aria-label":"password",autoComplete:"off",...S("passwd",{required:!0,maxLength:P})}),e(o.Buttons,{children:e(w,{onClick:W,children:e(p,{iconName:`fa-solid ${T}`,className:a.icon})})})]})})})}),e(g,{classNames:"fade",timeout:300,in:J,unmountOnExit:!0,nodeRef:v,children:e("div",{ref:v,children:r(w,{block:!0,variant:f.success,size:u.lg,disabled:k||!V||!d,onClick:j,children:["Register",k&&e(ee,{})]})})}),e("div",{className:a.errorMsg,children:e(g,{in:!!N,timeout:300,nodeRef:M,unmountOnExit:!0,classNames:"fade",children:e("span",{ref:M,className:"errorMessage",children:N})})})]}),r("div",{className:a.bottomBlock,children:[r("div",{className:a.social,children:[e("h5",{className:a.title,children:"Join our Discord's proof-market channel/Telegram for questions/to stay updated"}),e(se,{socialLinks:ae})]}),e("h5",{className:"text-center text-muted",children:"Already have an account? "}),e(re,{to:U.login,state:x,children:e(w,{block:!0,variant:f.success,size:u.lg,children:"Sign in"})})]})]})})},me=()=>r(ne,{children:[e(ie,{children:e("title",{children:"Register"})}),e(le,{})]});export{me as default};
